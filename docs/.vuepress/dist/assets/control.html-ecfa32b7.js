import{_ as e,r as p,o,c as l,d as s,e as n,b as i,a}from"./app-2ba3cb9f.js";const r={},c=a('<h1 id="云控" tabindex="-1"><a class="header-anchor" href="#云控" aria-hidden="true">#</a> 云控</h1><p>云端控制,可满足企业对设备的批量管理</p><p>如:批量启动小程序,批量停止,自定义指令等.</p><h2 id="http-对接" tabindex="-1"><a class="header-anchor" href="#http-对接" aria-hidden="true">#</a> http 对接</h2><ul><li>什么是Http方式对接?</li></ul><img src="https://airscript.oss-cn-hangzhou.aliyuncs.com/res/开发文档/doc_control_web.jpg"><p>AirScript App 启动后内置了websocket通道,并主动连接了 AirScript 服务器.</p><p>服务器开放了Http接口,通过参数,发送消息给指定的Websocket 通道</p><p>这样就形成了 http方式 传递消息给设备.</p><h3 id="app连接云控" tabindex="-1"><a class="header-anchor" href="#app连接云控" aria-hidden="true">#</a> App连接云控</h3><p>将设备连接至AirScript 云控服务器.</p><ul><li><p>如何连接?</p></li><li><ol><li>在首页,点击第4个状态按钮,即可打开云控连接弹窗.</li></ol></li><li><ol start="2"><li>输入AirScript 开发者账号,点击连接即可.</li></ol></li></ul><p>如图所示:</p><img src="https://airscript.oss-cn-hangzhou.aliyuncs.com/res/开发文档/doc_control_app_click.jpg" style="width:200px;"><h3 id="token获取" tabindex="-1"><a class="header-anchor" href="#token获取" aria-hidden="true">#</a> token获取</h3>',15),u={href:"http://py.airscript.cn/admin",target:"_blank",rel:"noopener noreferrer"},d=a(`<p>所有接口访问都需要Token值,传入header 中.</p><ul><li>请求地址:</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span>py<span class="token punctuation">.</span>airscript<span class="token punctuation">.</span>cn<span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token operator">/</span>devLogin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>参数:</li></ul><table><thead><tr><th>参数</th><th style="text-align:center;">必须</th><th style="text-align:right;">备注</th></tr></thead><tbody><tr><td>name</td><td style="text-align:center;">必填</td><td style="text-align:right;">开发者账号</td></tr><tr><td>pwd</td><td style="text-align:center;">必填</td><td style="text-align:right;">开发者账号密码</td></tr></tbody></table><ul><li>返回结果:</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;07ec7e2261dc5c4dc************&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;游自在&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;mobile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;开发者4&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;is_vip&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;vip_expired&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2100-01-01 00:00:00&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;vipId&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;vipName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;is_ad&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;applyList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回值中的 data.token 就是我们要获取的 token值</p><h3 id="在线设备列表" tabindex="-1"><a class="header-anchor" href="#在线设备列表" aria-hidden="true">#</a> 在线设备列表</h3><p>获取所有在线设备</p><ul><li>请求地址:</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span>py<span class="token punctuation">.</span>airscript<span class="token punctuation">.</span>cn<span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token operator">/</span>getDeviceList
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Header参数:</li></ul><table><thead><tr><th>Header 参数</th><th style="text-align:center;">必须</th><th style="text-align:right;">备注</th></tr></thead><tbody><tr><td>token</td><td style="text-align:center;">必填</td><td style="text-align:right;">通过 开发者账号与密码获取的值,请见接口<a href="#token%E8%8E%B7%E5%8F%96">token获取</a></td></tr></tbody></table><h3 id="发送指令" tabindex="-1"><a class="header-anchor" href="#发送指令" aria-hidden="true">#</a> 发送指令</h3><p>通过发送指令,可通知设备启动,停止,或自定义事件.</p><ul><li>请求地址:</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span>py<span class="token punctuation">.</span>airscript<span class="token punctuation">.</span>cn<span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token operator">/</span>con<span class="token operator">/</span>sendMsg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Header参数:</li></ul><table><thead><tr><th>Header 参数</th><th style="text-align:center;">必须</th><th style="text-align:right;">备注</th></tr></thead><tbody><tr><td>token</td><td style="text-align:center;">必填</td><td style="text-align:right;">通过 开发者账号与密码获取的值,请见接口<a href="#token%E8%8E%B7%E5%8F%96">token获取</a></td></tr></tbody></table><ul><li>body 参数:</li></ul><p>在这里我们需要 传递 body参数 以raw json 格式传递.</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;deviceIdList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;1111&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2222&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;aaa&quot;</span><span class="token operator">:</span> <span class="token string">&quot;111&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;bbb&quot;</span><span class="token operator">:</span> <span class="token string">&quot;222&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>json属性解释:</li></ul><table><thead><tr><th>参数</th><th style="text-align:center;">类型</th><th style="text-align:right;">必须</th><th style="text-align:right;">备注</th></tr></thead><tbody><tr><td>path</td><td style="text-align:center;">string</td><td style="text-align:right;">必填</td><td style="text-align:right;">命令标识,可自定义,注意不要和系统保留path重复.</td></tr><tr><td>deviceIdList</td><td style="text-align:center;">string数组</td><td style="text-align:right;">必填</td><td style="text-align:right;">当为空数组:发给所有设备<br>非空数组: 发给指定设备</td></tr><tr><td>params</td><td style="text-align:center;">对象参数</td><td style="text-align:right;">必填</td><td style="text-align:right;">可自定义参数,根据需求自行拓展</td></tr></tbody></table><ul><li>返回值:</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;msg&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ok&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例-运行小程序" tabindex="-1"><a class="header-anchor" href="#案例-运行小程序" aria-hidden="true">#</a> 案例:运行小程序</h3><ul><li>请求地址:</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span>py<span class="token punctuation">.</span>airscript<span class="token punctuation">.</span>cn<span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token operator">/</span>con<span class="token operator">/</span>sendMsg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>header参数:</li></ul><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">token</span><span class="token punctuation">:</span> <span class="token header-value">******* 通过账号密码获取的值</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>body raw json 参数</li></ul><p>该参数中的 scriptid 为 开发者后台上传小程序的id</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/device/start&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;deviceIdList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;scriptid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;19&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例-停止小程序" tabindex="-1"><a class="header-anchor" href="#案例-停止小程序" aria-hidden="true">#</a> 案例:停止小程序</h3><ul><li>请求地址:</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>http<span class="token punctuation">:</span><span class="token operator">//</span>py<span class="token punctuation">.</span>airscript<span class="token punctuation">.</span>cn<span class="token operator">/</span>api<span class="token operator">/</span>v1<span class="token operator">/</span>con<span class="token operator">/</span>sendMsg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>header参数:</li></ul><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">token</span><span class="token punctuation">:</span> <span class="token header-value">******* 通过账号密码获取的值</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>body raw json 参数</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/device/stop&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;deviceIdList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自定义指令" tabindex="-1"><a class="header-anchor" href="#自定义指令" aria-hidden="true">#</a> 自定义指令</h3><ul><li>什么是自定义指令?</li></ul><p>我们可以随意定义 path 和 params 参数,这样就形成了一条自定义指令.</p><ul><li>自定义指令如何在小程序里接收?</li></ul><p>小程序中写入代码,监听通道消息.</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> airscript<span class="token punctuation">.</span>system <span class="token keyword">import</span> Channel
<span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>

Channel<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>发送自定义消息 我们用 PostMan 模拟 发送指令 <img src="https://airscript.oss-cn-hangzhou.aliyuncs.com/res/开发文档/doc_air_ws_send_demo.jpg"></li></ul><hr><p>接着我们在编辑器命令行查看,已经打印了发送的消息</p><img src="https://airscript.oss-cn-hangzhou.aliyuncs.com/res/开发文档/doc_ws_send_demo_receive.jpg">`,52);function k(h,v){const t=p("ExternalLinkIcon");return o(),l("div",null,[c,s("p",null,[n("我们可以通过开发者账号与密码获取到token值 "),s("a",u,[n("前去注册开发者账号"),i(t)]),n(".")]),d])}const g=e(r,[["render",k],["__file","control.html.vue"]]);export{g as default};
